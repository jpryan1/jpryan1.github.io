---
layout: post
title: "Heat, Laplace's Equation and Random Walks on Spheres (Part 2 - the randomness)"
category: Science/Programming
---

<script type="text/javascript"
    src="http://cdn.mathjax.org/mathjax/latest/MathJax.js?config=TeX-AMS-MML_HTMLorMML">
</script>

So the stage is set. If we have our metal plate, and we know what its boundary looks like (a square, a triangle, etc.), and we know what temperature the boundary must be (imagine the flat-irons keeping the temperature at the boundary constant), then we can solve Laplace's Equation to find out what the temperature distribution will be in steady state. Mathematically,

- We have a domain (the plate): \\(D\in R^2\\),
- We have a boundary (the plate's edges) \\(\partial D\in R^2\\), 
- We have the temperature at the boundary: \\(u(x,y) = f(x,y)\\) for \\((x,y)\in \partial D\\),
- We are looking for \\(u(x,y)\\), the temperature at any point \\((x,y)\in D\\). This function solves \\(\frac{\partial^2 u}{\partial x^2} + \frac{\partial^2 u}{\partial y^2} = 0\\). 
    
    
_(side note: you'll notice that I'm writing \\(u(x,y)\\) instead of \\(u(x,y,t)\\) in this post. The reason is that I will be discussing the temperature distribution at steady state, wherein the temperature no longer depends on time.)_

To make things concrete, let's look at this steady state from the previous post:
<div style="text-align:center;">
<figure>
<a href="/images/kak/square1.png">
<img style="width:400px;" src="/images/kak/square1.png" />
</a>
</figure>
</div>
In this image, our domain (plate) is every point \\((x,y)\\) where \\(0\leq x\leq 1\\) and \\(0\leq y\leq 1\\). Notice that this is a square subset of \\(R^2\\). Our boundary (plate's edges) is every point on the perimeter of the aforementioned square. 

Our temperature at the boundary is as follows: the left wall is 100 degrees, and the other walls are 70 degrees. To be a bit more mathy, we say that our temperature at the boundary is the function \\(f(x,y)\\) where 

- \\(f(x,y)=100\\) for \\(x=0\\) and \\(0\leq y\leq 1\\), and 
- \\(f(x,y)=70\\) for \\(x=1\\) and \\(0\leq y\leq 1\\), for \\(y=0\\) and \\(0\leq x\leq 1\\), and for \\(y=1\\) and \\(0\leq x\leq 1\\).

The point in writing out these boring details is to illustrate that we can capture the temperature at the boundary with the function \\(f(x,y)\\). 

The program that generated the above image approximated the solution Laplace's Equation with the input boundary conditions (the shape of the boundary and temperature along it) to find the temperature distribution in the plate. How did it do this? To find out, let us now talk about random things. 

Here are our goals

1. Define a random walk, and the Wiener process.
2. Discuss the expectation of a function of a Wiener process.
3. Use these tools to solve Laplace's equation.
4. Convert the solution into an algorithm.

### What is a random walk? What is the Wiener process?

Suppose you are on a giant checkerboard, and you are standing in a square. Suppose further that, to step from your square to an adjacent (not diagonal) square, you step a distance of 1 meter. The path that you take as you step from square to square in that checkerboard (wondering how you got there) is called a walk.

Now imagine you perform this walk randomly in the following way: at every second, you decide which adjacent square to step onto by picking a direction at random. Any direction has equal probability of being selected (you could decide what direction to go by drawing a card from a deck, and heading north if it's spades, south if it's hearts, and so on). Here's a picture of what that walk might look like:
<div style="text-align:center;">
<figure>
<a href="/images/kak/walk.gif">
<img style="width:400px;" src="/images/kak/walk.gif" />
</a>
<figcaption > Source: http://mathworld.wolfram.com/RandomWalk2-Dimensional.html </figcaption>
</figure>
</div>
There are two parameters to notice here: we're taking a step of distance 1 meter, and we are taking it every 1 seconds. Let's be a bit more general: in your walk,  take a step of distance \\(\sqrt{t}\\) meters once every \\(t\\) seconds. In our original example, we have \\(t=1\\). 

The Wiener process is like a continuous version of the random walk described above, and it is equivalent to the limit of the above random walk as \\(t \rightarrow 0\\) (think about it this way: instead of taking discrete steps, you are continuously changing direction). Here is what the 2D Wiener process looks like:
<!-- blog post idea - drunk bird doesn't get home -->
<div style="text-align:center;">
<figure>
<a href="/images/kak/wiener.png">
<img style="width:400px;" src="/images/kak/wiener.png" />
</a>
<figcaption > Source: http://jonsson.eu/programs/cweb/wiener/ </figcaption>
</figure>
</div>

Besides being the foundation for the mathematical study of stochastic differential equations, this process also has applications in physics, finance, and more. For our purposes, it's enough to know that it's basically a continuous random walk. Here's a video showing a simulation of the path taken by a Wiener process. 
<iframe align="center" width="560" height="315" src="https://www.youtube.com/embed/pTYe5ssPD3k" frameborder="0" allowfullscreen></iframe>

<!--
If we wanted to do some math on this walk, we could represent it by a function of time that returns a 2D coordinate (ie which square the walker stands on after the given amount of time). More specifically, we can represent the walk by \\(f(t)\\), where 

\\(f(t) = \sum_i=1^t X_i \\)

where \\(X_i\\) is a random variable which is \\((1,0)\\) with probability 1/4, \\((0,1)\\) with probability 1/4, \\((-1,0)\\) with probability 1/4, and \\((0,-1)\\) with probability 1/4. 
-->

### What is the expectation of a function of a Wiener process?

First, let's take note of the fact that a 2D Wiener process is like a mapping which takes a time \\(t\\) and returns a 2D coordinate \\((x,y)\\). From now on, we will denote the Wiener process by \\(W_t\\). For example, in the above video, \\(W_0 = (0,0)\\) since the process starts at the origin. However we must keep this critical fact in mind: \\(W_t\\) is a _random variable_, and it does _not_ have a definite value, but rather a probability distribution (like the toss of a die, or the flip of a coin). 

Now let's remember our temperature function \\(u(x,y)\\), which takes a 2D coordinate \\((x,y)\\) and returns a number representing the temperature at that point in space. What if, instead of passing a definite coordinate \\((x,y)\\), we talk about the temperature at the random coordinate \\(W_t\\)? Let us define \\(g(t)=u(W_t)\\), to be the function which returns the temperature at the coordinate that the Wiener process (think random walker on plane) has arrived at after \\(t\\) seconds. 

### How does this help us with Laplace's equation?

### How do we code this?

